# 系统架构设计文档

## 1. 系统架构图

```mermaid
graph TD
    A[用户浏览器] --> B{Nginx反向代理}
    B --> C[前端应用(Vue.js)]
    C --> D[后端API服务(Express.js)]
    D --> E[(SQLite数据库)]
    D --> F[阿里百炼API]
    
    subgraph 前端层
        C
    end
    
    subgraph 后端服务层
        D
    end
    
    subgraph 数据存储层
        E
    end
    
    subgraph 外部服务层
        F
    end
```

## 2. 架构层次说明

### 2.1 前端层
- **技术栈**：Vue.js 3 + Element Plus + Vite
- **主要职责**：
  - 提供用户界面交互
  - 处理用户输入和显示AI回答
  - 管理对话历史展示
  - 与后端API通信

### 2.2 后端服务层
- **技术栈**：Node.js + Express.js
- **主要职责**：
  - 提供RESTful API接口
  - 处理业务逻辑
  - 管理对话上下文
  - 与阿里百炼API通信
  - 管理数据库操作

### 2.3 数据存储层
- **技术栈**：SQLite
- **主要职责**：
  - 存储对话历史记录
  - 维护用户会话信息

### 2.4 外部服务层
- **阿里百炼API**：
  - 提供AI问答能力
  - 支持流式响应

## 3. 数据流向

### 3.1 用户提问流程
1. 用户在前端界面输入问题
2. 前端通过HTTP请求将问题发送到后端
3. 后端整合上下文信息，调用阿里百炼API
4. 阿里百炼API流式返回回答
5. 后端将回答实时转发给前端
6. 前端动态展示回答内容
7. 对话记录保存到SQLite数据库

### 3.2 查看历史记录流程
1. 用户点击历史记录
2. 前端请求后端获取历史对话列表
3. 后端从SQLite查询对话记录
4. 返回给前端展示

## 4. 模块设计

### 4.1 对话模块
- 管理多轮对话上下文
- 处理用户输入和AI回答
- 维护对话状态

### 4.2 历史记录模块
- 存储和查询对话历史
- 管理对话生命周期

### 4.3 API通信模块
- 与阿里百炼API交互
- 处理流式响应数据

## 5. 部署架构

### 5.1 MVP阶段部署
- 单机部署
- SQLite本地文件存储
- Node.js直接运行或使用PM2进程管理

### 5.2 后续扩展考虑
- 使用Docker容器化部署
- Nginx反向代理和负载均衡
- 迁移至PostgreSQL等企业级数据库